# -----------------------------------------------------------------------------
# SQM Middleware REST host runtime configuration template
#
# This file is a template. Uncomment and adjust values for your environment.
# System properties and environment variables can still override these values.
# -----------------------------------------------------------------------------

# --- Schema source ------------------------------------------------------------
# Runtime mode:
# sqm.middleware.runtime.mode=dev
# sqm.middleware.productionMode=false
# In production mode, schema source must be explicit; manual mode also requires
# sqm.middleware.schema.defaultJson.path (bundled fallback is disabled).
#
# Supported values: manual | json | jdbc
# manual = load default schema from JSON file/resource (not hardcoded model)
# sqm.middleware.schema.source=json
# Controls startup behavior on schema bootstrap failure:
# true  = fail startup immediately
# false = start degraded (readiness NOT_READY; requests denied with pipeline error)
# sqm.middleware.schema.bootstrap.failFast=true

# Optional explicit default JSON path used when source=manual
# sqm.middleware.schema.defaultJson.path=./schema/default-schema.json

# JSON schema source
# sqm.middleware.schema.json.path=./schema.json

# JDBC schema source
# sqm.middleware.jdbc.url=jdbc:postgresql://localhost:5432/mydb
# sqm.middleware.jdbc.user=postgres
# sqm.middleware.jdbc.password=postgres
# sqm.middleware.jdbc.driver=org.postgresql.Driver
# sqm.middleware.jdbc.schemaPattern=public

# --- Rewrite pipeline ---------------------------------------------------------
# Enable/disable rewrite stage in middleware config
# sqm.middleware.rewrite.enabled=true

# Comma-separated built-in rules, for example:
# LIMIT_INJECTION,SCHEMA_QUALIFICATION,COLUMN_QUALIFICATION,CANONICALIZATION
# sqm.middleware.rewrite.rules=LIMIT_INJECTION,CANONICALIZATION

# Optional rewrite settings
# sqm.middleware.rewrite.defaultLimitInjectionValue=1000
# sqm.middleware.rewrite.maxAllowedLimit=5000
# sqm.middleware.rewrite.limitExcessMode=DENY
# sqm.middleware.rewrite.qualificationDefaultSchema=public
# sqm.middleware.rewrite.qualificationFailureMode=DENY
# sqm.middleware.rewrite.identifierNormalizationCaseMode=LOWER

# --- Validation limits --------------------------------------------------------
# Optional inline validation settings payload (choose one):
# sqm.validation.settings.json={"tenantRequirementMode":"REQUIRED","accessPolicy":{"tenants":[{"name":"tenant-a","deniedTables":["payments"]}]}}
# sqm.validation.settings.yaml=tenantRequirementMode: REQUIRED\naccessPolicy:\n  tenants:\n    - name: tenant-a\n      deniedTables:\n        - payments
#
# Optional tenant strictness override at runtime:
# sqm.middleware.validation.tenantRequirementMode=REQUIRED
#
# sqm.middleware.validation.maxJoinCount=8
# sqm.middleware.validation.maxSelectColumns=64

# --- Runtime guardrails -------------------------------------------------------
# sqm.middleware.guardrails.maxSqlLength=10000
# sqm.middleware.guardrails.timeoutMillis=2500
# sqm.middleware.guardrails.maxRows=1000
# sqm.middleware.guardrails.explainDryRun=false

# --- REST host security and abuse controls -----------------------------------
# Enable API-key authentication for /sqm/middleware/**
# sqm.middleware.rest.security.apiKeyEnabled=false
# sqm.middleware.rest.security.apiKeyHeader=X-API-Key
# sqm.middleware.rest.security.apiKeys=dev-key-1,dev-key-2
#
# Enable rate limiting per client address (fixed window)
# sqm.middleware.rest.abuse.rateLimitEnabled=false
# sqm.middleware.rest.abuse.requestsPerWindow=60
# sqm.middleware.rest.abuse.windowSeconds=60
#
# Maximum accepted request body size in bytes
# sqm.middleware.rest.abuse.maxRequestBytes=65536

# --- Observability and audit --------------------------------------------------
# Correlation id header propagated on every middleware response:
# X-Correlation-Id
#
# Audit publisher mode: noop | logging | file
# sqm.middleware.audit.publisher=noop
#
# Logging audit publisher options
# sqm.middleware.audit.logger.name=io.sqm.middleware.audit
# sqm.middleware.audit.logger.level=INFO
#
# File audit publisher option (required when mode=file)
# sqm.middleware.audit.file.path=./logs/sqm-audit.log
#
# Telemetry metrics logging
# sqm.middleware.metrics.enabled=false
# sqm.middleware.metrics.logger.name=io.sqm.middleware.metrics
# sqm.middleware.metrics.logger.level=INFO

# --- Host flow control (concurrency/backpressure/timeout) --------------------
# Maximum in-flight middleware requests (transport-neutral wrapper)
# sqm.middleware.host.maxInFlight=64
#
# Optional semaphore acquire timeout before rejecting for backpressure
# sqm.middleware.host.acquireTimeoutMillis=0
#
# Optional host-level request timeout (end-to-end wrapper timeout)
# sqm.middleware.host.requestTimeoutMillis=5000
